<?xml version="1.0" encoding="UTF-8"?>
<!--Sample XML file generated by XML Spy v4.4 U (http://www.xmlspy.com)-->
<SPEAR-CONFIG xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="C:\app\DB-FOBOCA\schema\spear_NEW.xsd">
	<MODULE>
		<NAME>Test Application</NAME>
		<DESCRIPTION>For Testing</DESCRIPTION>
		<CYCLE-DEPENDENCIES>
			<ASSERTER CLASS="com.cs.sg.spear.core.cycledependency.ShutdownTimeCheckDependant"/>
			<ASSERTER CLASS="com.cs.sg.spear.core.cycledependency.EndCycleCheckDependant"/>
			<ASSERTER CLASS="com.cs.sg.spear.core.cycledependency.ProcessTerminationCheckDependant"/>
			<ASSERTER CLASS="com.cs.sg.spear.core.cycledependency.CycleCountCheckDependant"/>
			<ASSERTER CLASS="com.cs.sg.spear.core.cycledependency.SystemGCForcer"/>
			<ASSERTER CLASS="com.cs.sg.spear.core.cycledependency.StatsCollector"/>
		</CYCLE-DEPENDENCIES>
		<MODULE-PARAM>
		   <PARAM NAME="spear.semaphore.check" VALUE="false"/>
		   <PARAM NAME="spear.keyassigner" VALUE="com.cs.sg.spear.impl.assigner.RoundRobinKeyAssigner"/>
		   <PARAM NAME="spear.cycle.interval" VALUE="5000"/>
  		   <PARAM NAME="spear.shutdown.format" VALUE="HH:mm"/>
		   <PARAM NAME="spear.shutdown" VALUE="16:04"/>
		   <PARAM NAME="driver.primary.keys" VALUE="INV_ID"/>
		   <PARAM NAME="spear.cycle.count" VALUE="-1"/>
		</MODULE-PARAM>
	</MODULE>
	<DATA-EXTRACTOR NAME="csvextractor">
		<PARAM NAME="data.provider" VALUE="dbtest"/>
	</DATA-EXTRACTOR>
	<DATA-TRANSFORMER NAME="trans" CLASS="com.cs.sg.spear.impl.transformer.TemplateBasedTransformer" POOL-SIZE="150" THREAD-COUNT="5" >
		<PARAM NAME="template.type" VALUE="string"/>
		<PARAM NAME="placeholder" VALUE="object"/>	
		<PARAM NAME="template.value" VALUE="${driver$INV_ID},${driver$INV_BRO_REF_NO},${brkr$CNP_CODE}-${brkr$CNP_NAME},${ent$ENT_CODE},${driver$INV_INVOICE_DATE},${driver$INV_TRADE_MONTH},${ccy$CUR_CODE},${driver$INV_AMOUNT},${driver$INV_SETTLE_DATE},${driver$INV_OWNER},${driver$INV_INVOICE_TYPE},${driver$INV_BUSINESS_STATUS},${driver$INV_RCVD_DATE},${driver$INV_ORG_INV_ID},${driver$INV_USER_FILE_NAME},${driver$INV_SYSTEM_FILE_NAME},${driver$INV_FILE_TYPE},${driver$INV_CREATE_BY},${driver$INV_CREATE_DATETIME},${driver$INV_CREATE_REMARKS},${driver$INV_MOD_BY},${driver$INV_MOD_DATETIME},${driver$INV_VERIFY_BY},${driver$INV_VERIFY_DATETIME},${driver$INV_VERIFY_REMARKS}"/>
		<PARAM NAME="ignore.null" VALUE="true"/>
		<PARAM NAME="replace.null.with" VALUE=""/>
		<PARAM NAME="rejection.report.type" VALUE="file"/>
		<PARAM NAME="rejection.report.source" VALUE="C:/app/spearnew/test/csv/report"/>
	</DATA-TRANSFORMER>
	<DATA-WRITERS ON-ERROR="ignore" THREAD-COUNT="5">
		<WRITER NAME="dbwrite" CLASS="com.cs.sg.spear.impl.writer.DBDataWriter">
			<PARAM NAME="single.reference" VALUE="true"/>
			<PARAM NAME="data.provider" VALUE="brinvh"/>
		</WRITER>
		<WRITER NAME="dbupdate" CLASS="com.cs.sg.spear.impl.writer.DBDataWriter"  DEPENDS="dbwrite">
			<PARAM NAME="single.reference" VALUE="true"/>
			<PARAM NAME="data.provider" VALUE="brupdt"/>
		</WRITER>
	</DATA-WRITERS>
	<RESOURCES>
		<RESOURCE NAME="DSGINS50" TYPE="DB" LOAD-PRIORITY="2" UNLOAD-PRIORITY="1">
			<PARAM NAME="driverClassName" VALUE="oracle.jdbc.OracleDriver"/>
			<PARAM NAME="connectionUrl" VALUE="jdbc:oracle:thin:@(description=(address_list= (address=(host=DSGINS51.sg.csfb.com) (protocol=tcp)(port=1522))(address=(host=DSGINS52.sg.csfb.com)(protocol=tcp) (port=1522)) (load_balance=no)(failover=yes))(connect_data=(service_name= DSGINS50.WORLD)))"/>
			<PARAM NAME="userName" VALUE="inspire_dev"/>
			<PARAM NAME="password" VALUE="inspire_dev"/>
			<PARAM NAME="poolSize" VALUE="25"/>
			<PARAM NAME="poolOnStart" VALUE="true"/>
			<PARAM NAME="maxWait" VALUE="5000"/>
			<PARAM NAME="defaultAutoCommit" VALUE="true"/>
		</RESOURCE>
	</RESOURCES>
<SERVICES>
		<SERVICE NAME="semaphore" CLASS="com.cs.sg.spear.impl.services.DBSemaphoreService" CYCLE-NOTIFICATION="true" APP-NOTIFICATION="true" DEPENDS="s1">
			<PARAM NAME="check.status" VALUE="semaphore_select"/>
			<PARAM NAME="update.status" VALUE="semaphore_update"/>			
			<PARAM NAME="pre.start.status" VALUE="C"/>
			<PARAM NAME="post.start.status" VALUE="P"/>
			<PARAM NAME="end.status" VALUE="C"/>
			<PARAM NAME="termination.status" VALUE="K"/>
		</SERVICE>
		<SERVICE NAME="s1" CLASS="com.cs.sg.spear.core.services.TestService" CYCLE-NOTIFICATION="true" APP-NOTIFICATION="true"/>
	</SERVICES>	
	<DATA-PROVIDERS>
		<DATA-PROVIDER NAME="dbtest" TYPE="DB">
			<QUERY><![CDATA[select * from br_inv_invoice where INV_INVOICE_TYPE='R']]></QUERY>
			<PARAM NAME="resource" VALUE="DSGINS50"/>
			<PARAM NAME="fetch.size" VALUE="500"/>
			<PARAM NAME="result.wrap" VALUE="disconnected"/>
		</DATA-PROVIDER>
		<DATA-PROVIDER NAME="entity" TYPE="DB">
			<QUERY><![CDATA[select * from in_ent_entity where 1=2]]></QUERY>
			<PARAM NAME="resource" VALUE="DSGINS50"/>
			<PARAM NAME="fetch.size" VALUE="0"/>
			<PARAM NAME="result.wrap" VALUE="discconnected"/>
			<PARAM NAME="cache.type" VALUE="begin.app"/>
		</DATA-PROVIDER>
		<DATA-PROVIDER NAME="currency" TYPE="DB">
			<QUERY><![CDATA[select * from in_cur_currency]]></QUERY>
			<PARAM NAME="resource" VALUE="DSGINS50"/>
			<PARAM NAME="fetch.size" VALUE="0"/>
			<PARAM NAME="result.wrap" VALUE="discconnected"/>
			<PARAM NAME="cache.type" VALUE="timer.refresh"/>
			<PARAM NAME="cache.refresh.time" VALUE="5000"/>
		</DATA-PROVIDER>
		<DATA-PROVIDER NAME="broker" TYPE="DB">
			<QUERY><![CDATA[ select * from IN_CNP_CNTR_PARTY where CNP_CNTR_PARTY_TYPE='Broker' and CNP_STATUS!='D']]></QUERY>
			<PARAM NAME="cache.type" VALUE="begin.app"/>
			<PARAM NAME="resource" VALUE="DSGINS50"/>
			<PARAM NAME="result.wrap" VALUE="connected"/>
			<PARAM NAME="cache.type" VALUE="incremental"/>	
		</DATA-PROVIDER>
		<DATA-PROVIDER NAME="brinvh" TYPE="DB">
			<QUERY><![CDATA[ INSERT INTO BR_INVH_INVOICE_H (INVH_ID,
				INVH_INV_ID,
				INVH_BRO_REF_NO,
				INVH_BROKER_ID,
				INVH_ENTITY_ID,
				INVH_INVOICE_DATE,
				INVH_TRADE_MONTH,
				INVH_CCY_ID,
				INVH_AMOUNT,
				INVH_SETTLE_DATE,
				INVH_OWNER,
				INVH_INVOICE_TYPE,
				INVH_BUSINESS_STATUS,
				INVH_RCVD_DATE,
				INVH_ORG_INV_ID,
				INVH_USER_FILE_NAME,
				INVH_SYSTEM_FILE_NAME,
				INVH_FILE_TYPE,
				INVH_CREATE_BY,
				INVH_CREATE_DATETIME,
				INVH_CREATE_REMARKS,
				INVH_MOD_BY,
				INVH_MOD_DATETIME,
				INVH_VERIFY_BY,
				INVH_VERIFY_DATETIME,
				INVH_VERIFY_REMARKS,
				INVH_OP_STATUS)
				values
				(${driver$INV_ID},
				${driver$INV_ID},
				${driver$INV_BRO_REF_NO},
				${driver$INV_BROKER_ID},
				${driver$INV_ENTITY_ID},
				${driver$INV_INVOICE_DATE},
				${driver$INV_TRADE_MONTH},
				${driver$INV_CCY_ID},
				${driver$INV_AMOUNT},
				${driver$INV_SETTLE_DATE},
				${driver$INV_OWNER},
				${driver$INV_INVOICE_TYPE},
				${driver$INV_BUSINESS_STATUS},
				${driver$INV_RCVD_DATE},
				${driver$INV_ID},
				${ccy$CUR_CODE},
				${brkr$CNP_NAME},
				${driver$INV_FILE_TYPE},
				${driver$INV_CREATE_BY},
				${driver$INV_CREATE_DATETIME},
				${driver$INV_CREATE_REMARKS},
				${driver$INV_MOD_BY},
				${driver$INV_MOD_DATETIME},
				${driver$INV_VERIFY_BY},
				${driver$INV_VERIFY_DATETIME},
				${driver$INV_VERIFY_REMARKS},
				'U'
				) ]]></QUERY>
				<PARAM NAME="resource" VALUE="DSGINS50"/>
			</DATA-PROVIDER>
			<DATA-PROVIDER NAME="brupdt" TYPE="DB">
				<QUERY><![CDATA[
					update BR_INV_INVOICE set INV_INVOICE_TYPE='P' where INV_ID=${driver$INV_ID}
					]]>
				</QUERY>
				<PARAM NAME="resource" VALUE="DSGINS50"/>
			</DATA-PROVIDER>
	</DATA-PROVIDERS>
	<DATA-LOOKUP>
		<LOOKUP NAME="ccy"  DATA-PROVIDER="currency">
			<FILTER><![CDATA[
				CUR_ID=${driver$INV_CCY_ID}
				]]>
			</FILTER>
			<COLUMNS>
			<![CDATA[
				CUR_CODE,CUR_ID
				]]>
			</COLUMNS>
		</LOOKUP>
		<LOOKUP NAME="ent"  DATA-PROVIDER="entity">
			<FILTER><![CDATA[
				ENT_ID=${driver$INV_ENTITY_ID}
				]]>
			</FILTER>
			<COLUMNS>
			<![CDATA[
				ENT_CODE,ENT_ID
				]]>
			</COLUMNS>
		</LOOKUP>
		<LOOKUP NAME="brkr"  DATA-PROVIDER="broker">
			<FILTER><![CDATA[
				CNP_ID=${driver$INV_BROKER_ID}
				]]>
			</FILTER>
			<COLUMNS>
			<![CDATA[
				CNP_CODE,CNP_NAME
				]]>
			</COLUMNS>
		</LOOKUP>
	</DATA-LOOKUP>	
	<EXCEPTION-HANDLER>
		<HANDLER CLASS="com.cs.sg.spear.core.exception.SpearExceptionHandler" NAME="default.exception.handler"/>
		<HANDLE EXCEPTION="com.cs.sg.spear.core.exception.EventNotifierException" HANDLER="default.exception.handler">
			<ERROR CODE="DBINIT_EA_SQL_EXP" VALUE="" TYPE="fatal"/>
			<ERROR CODE="SEMAPHORE_BA_LOCKED" VALUE="" TYPE="fatal"/>
			<ERROR CODE="SEMAPHORE_UNKNOWN" VALUE="" TYPE="fatal"/>
			<ERROR CODE="SEMAPHORE_BA_PROVIDER_NOT_FOUND" VALUE="" TYPE="fatal"/>
			<ERROR CODE="MQ_INIT_BEGIN_APP_JMS_EXP" VALUE="" TYPE="fatal"/>
			<ERROR CODE="MQ_INIT_BEGIN_APP_EXP" VALUE="" TYPE="ignore"/>
			<ERROR CODE="JMS_INIT_BEGIN_APP_EXP" VALUE="" TYPE="ignore"/>
			<ERROR CODE="SEMAPHORE_EA_EXP" VALUE="" TYPE="ignore"/>
			<ERROR CODE="CACHE_PROVIDER_BA_DATA_EXP" VALUE="" TYPE="ignore"/>
			<ERROR CODE="CACHE_PROVIDER_BA_EXP" VALUE="" TYPE="ignore"/>
			<ERROR CODE="CACHE_PROVIDER_EC_EXP" VALUE="" TYPE="ignore"/>
			<ERROR CODE="CACHE_PROVIDER_EC_DATA_EXP" VALUE="" TYPE="ignore"/>
			<ERROR CODE="CACHE_PROVIDER_BC_EXP" VALUE="" TYPE="ignore"/>
			<ERROR CODE="CACHE_PROVIDER_BC_DATA_EXP" VALUE="" TYPE="ignore"/>
		</HANDLE>
		<HANDLE EXCEPTION="com.cs.sg.spear.core.exception.InitializationException" HANDLER="default.exception.handler">
			<ERROR CODE="TOKEN_DBPARAM_EXIST" VALUE="" TYPE="ignore"/>
			<ERROR CODE="APP_INITIALIZATION_EXP" VALUE="" TYPE="fatal"/>
			<ERROR CODE="DB_INIT_BEGIN_APP_SQL_EXP" VALUE="" TYPE="ignore"/>
			<ERROR CODE="DB_INIT_BEGIN_APP_EXP" VALUE="" TYPE="ignore"/>
			<ERROR CODE="MANDATORY_PARAM_MISSING" VALUE="" TYPE="ignore"/>
			<ERROR CODE="MW_SESSION_EX" VALUE="" TYPE="fatal"/>
			<ERROR CODE="MORE_THAN_ONE_MATCH" VALUE="" TYPE="fatal"/>
		</HANDLE>
		<HANDLE EXCEPTION="com.cs.sg.spear.core.exception.SpearRuntimeException" HANDLER="default.exception.handler">
			<ERROR CODE="FILE_NOT_ARRIVED" VALUE="" TYPE="fatal"/>
		</HANDLE>
		<HANDLE EXCEPTION="java.sql.SQLException" HANDLER="default.exception.handler">
			<ERROR CODE="any" VALUE="Invalid column name" TYPE="fatal"/>
		</HANDLE>
		<HANDLE EXCEPTION="com.cs.sg.spear.core.exception.ValidatorException" HANDLER="default.exception.handler">
			<ERROR CODE="INVALID_FILE" VALUE="" TYPE="fatal"/>
		</HANDLE>
		<HANDLE EXCEPTION="com.cs.sg.spear.core.exception.ResourceException" HANDLER="default.exception.handler">
			<ERROR CODE="SQL_EXCEPTION_CON" VALUE="" TYPE="fatal"/>
			<ERROR CODE="DB_DATASOURCE_CREATION" VALUE="" TYPE="fatal"/>
			<ERROR CODE="DB_BATCH_NOT_SUPPORT" VALUE="" TYPE="fatal"/>
		</HANDLE>
	</EXCEPTION-HANDLER>
</SPEAR-CONFIG>
