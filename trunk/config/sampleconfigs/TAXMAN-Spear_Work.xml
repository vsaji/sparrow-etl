<?xml version="1.0" encoding="UTF-8"?>
<!--Sample XML file generated by XML Spy v4.4 U (http://www.xmlspy.com)-->
<SPEAR-CONFIG xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="spear.xsd">
	<MODULE>
		<NAME>Taxman File upload</NAME>
		<PROCESS-ID>Taxman</PROCESS-ID>
		<DESCRIPTION>Taxman File upload</DESCRIPTION>
		<CYCLE-DEPENDENCIES>
			<ASSERTER CLASS="com.cs.sg.spear.core.cycledependency.SystemGCForcer"/>
			<ASSERTER CLASS="com.cs.sg.spear.core.cycledependency.StatsCollector"/>
		</CYCLE-DEPENDENCIES>
		<MODULE-PARAM>
		   <PARAM NAME="spear.semaphore.check" VALUE="false"/>
		   <PARAM NAME="spear.keyassigner" VALUE="com.cs.sg.spear.impl.assigner.RoundRobinKeyAssigner"/>
                   <PARAM NAME="taxman.feed.delimit" VALUE="@@feed.delimit@@"/>
               	   <PARAM NAME="taxman.col.def" VALUE="@@col.def@@"/> 
               	   <PARAM NAME="taxman.file.name" VALUE="@@file.name@@"/> 
                   <PARAM NAME="taxman.base.dir" VALUE="@@base.dir@@"/>
                   <PARAM NAME="taxman.syb.server" VALUE="@@syb.server@@"/>
                   <PARAM NAME="taxman.syb.tempdb" VALUE="@@syb.tempdb@@"/> 
                   <PARAM NAME="taxman.syb.tempdbuname" VALUE="@@syb.tempdbuname@@"/>
                   <PARAM NAME="taxman.syb.tempdbpwd" VALUE="@@syb.tempdbpwd@@"/>
                   <PARAM NAME="spear.cycle.count" VALUE="1"/>
		</MODULE-PARAM>
	</MODULE>
	<DATA-EXTRACTOR NAME="driver" TYPE="CSV">
		<PARAM NAME="fetch.size" VALUE="500"/>
		<PARAM NAME="result.wrap" VALUE="disconnected"/>
		<PARAM NAME="file.path" VALUE="p:\"/>
		<PARAM NAME="file.name" VALUE="IICAPS_Sample_testing.csv"/>
		<PARAM NAME="file.delimiter" VALUE="${module@taxman.feed.delimit}"/>
        <PARAM NAME="column.definition" VALUE="${module@taxman.col.def}"/>
		<PARAM NAME="trim.value" VALUE="true"/>
		<PARAM NAME="start.line.number" VALUE="2"/>
		<PARAM NAME="validation.required" VALUE="false"/>
		<PARAM NAME="rejection.report.type" VALUE="file"/>
		<PARAM NAME="rejection.report.source" VALUE="p:/"/>
		<PARAM NAME="fail.dir" VALUE="p:/"/>
	</DATA-EXTRACTOR>
	
	<DATA-TRANSFORMER NAME="fitTransform" CLASS="com.cs.sg.spear.impl.transformer.DummyDataTransformer" POOL-SIZE="1" THREAD-COUNT="1" >
		<PARAM NAME="template.type" VALUE="string"/>
		<PARAM NAME="placeholder" VALUE="object"/>
		<PARAM NAME="template.value" VALUE="Dummy"/>
		<PARAM NAME="ignore.null" VALUE="true"/>
		<PARAM NAME="replace.null.with" VALUE=""/>
		<PARAM NAME="rejection.report.type" VALUE="file"/>
		<PARAM NAME="rejection.report.source" VALUE="${module@taxman.base.dir}/logs"/>
	</DATA-TRANSFORMER>
	<DATA-WRITERS ON-ERROR="ignore" THREAD-COUNT="5">
		<WRITER NAME="dbwrite1" TYPE="DB" >
			<PARAM NAME="query"><![CDATA[
BEGIN
                        insert into tempdb..Entitlement_test ( EntitlementID , AccountNum  ,EventType ,CurrencyCode,DivRatePerShare,EntitledPosition,RecDate ) values ( '${driver$destinationsystemid}', '${driver$contraflag}',        '${driver$ird}', '${driver$txnType}','${driver$actionid}',${driver$position},${driver$recorddate})                    
                    END
 		 ]]>
			</PARAM>
			<PARAM NAME="resource" VALUE="TAXSYB"/>
			<PARAM NAME="batch.size" VALUE="1"/>
		</WRITER>
	</DATA-WRITERS>


	<RESOURCES>

		<RESOURCE NAME="TAXSYB" TYPE="DB" LOAD-PRIORITY="2" UNLOAD-PRIORITY="1">
		<PARAM NAME="driver.classname" VALUE="com.sybase.jdbc2.jdbc.SybDriver"/>
                <PARAM NAME="connection.url" VALUE="jdbc:sybase:Tds:${module@taxman.syb.server}/${module@taxman.syb.tempdb}"/>		
                <PARAM NAME="user.name" VALUE="${module@taxman.syb.tempdbuname}"/>
		<PARAM NAME="password" VALUE="${module@taxman.syb.tempdbpwd}"/>
		<PARAM NAME="pool.size" VALUE="10"/>
		<PARAM NAME="pool.on.start" VALUE="false"/>
		<PARAM NAME="max.wait" VALUE="5000"/>
		<PARAM NAME="default.autocommit" VALUE="true"/>
		</RESOURCE>

	
	</RESOURCES>	

       <DATA-PROVIDERS>
                <DATA-PROVIDER NAME="DEST_CHECK" TYPE="DB">
                <PARAM NAME="query"><![CDATA[
                        BEGIN   
                                select destination from tempdb..taxman_table                          
                       END 
                 ]]></PARAM>
                <PARAM NAME="resource" VALUE="TAXSYB"/>
                <PARAM NAME="fetch.size" VALUE="1"/>
                <PARAM NAME="result.wrap" VALUE="disconnected"/>
                </DATA-PROVIDER>
        </DATA-PROVIDERS>

        <DATA-LOOKUP>
                <LOOKUP NAME="CHECK"  DATA-PROVIDER="DEST_CHECK">
                </LOOKUP>
        </DATA-LOOKUP>

		<EXCEPTION-HANDLER>
		<HANDLER CLASS="com.cs.sg.spear.core.exception.SpearExceptionHandler" NAME="default.exception.handler"/>
		<HANDLE EXCEPTION="com.cs.sg.spear.core.exception.EventNotifierException" HANDLER="default.exception.handler">
			<ERROR CODE="DBINIT_EA_SQL_EXP" VALUE="" TYPE="fatal"/>
			<ERROR CODE="SEMAPHORE_BA_LOCKED" VALUE="" TYPE="fatal"/>
			<ERROR CODE="SEMAPHORE_UNKNOWN" VALUE="" TYPE="fatal"/>
			<ERROR CODE="SEMAPHORE_BA_PROVIDER_NOT_FOUND" VALUE="" TYPE="fatal"/>
		</HANDLE>
		<HANDLE EXCEPTION="com.cs.sg.spear.core.exception.InitializationException" HANDLER="default.exception.handler">
			<ERROR CODE="TOKEN_DBPARAM_EXIST" VALUE="" TYPE="ignore"/>
			<ERROR CODE="APP_INITIALIZATION_EXP" VALUE="" TYPE="fatal"/>
			<ERROR CODE="LOCALJMS_INIT_EXP" VALUE="" TYPE="ignore"/>
		</HANDLE>
		<HANDLE EXCEPTION="com.cs.sg.spear.core.exception.SpearRuntimeException" HANDLER="default.exception.handler">
			<ERROR CODE="FILE_NOT_ARRIVED" VALUE="" TYPE="fatal"/>
		</HANDLE>
		<HANDLE EXCEPTION="java.sql.SQLException" HANDLER="default.exception.handler">
			<ERROR CODE="any" VALUE="Invalid column name" TYPE="fatal"/>
			<ERROR CODE="any" VALUE="invalid identifier" TYPE="ignore"/>
			<ERROR CODE="00001" VALUE="unique constraint" TYPE="fatal"/>
		</HANDLE>
		<HANDLE EXCEPTION="com.cs.sg.spear.core.exception.ValidatorException" HANDLER="default.exception.handler">
			<ERROR CODE="INVALID_FILE" VALUE="" TYPE="fatal"/>
		</HANDLE>
		<HANDLE EXCEPTION="com.cs.sg.spear.core.exception.ResourceException" HANDLER="default.exception.handler">
			<ERROR CODE="SQL_EXCEPTION_CON" VALUE="" TYPE="fatal"/>
			<ERROR CODE="DB_DATASOURCE_CREATION" VALUE="" TYPE="fatal"/>
			<ERROR CODE="DB_BATCH_NOT_SUPPORT" VALUE="" TYPE="fatal"/>
		</HANDLE>
	</EXCEPTION-HANDLER>
</SPEAR-CONFIG>
