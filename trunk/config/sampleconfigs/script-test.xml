<?xml version="1.0" encoding="UTF-8"?>
<!--Sample XML file generated by XML Spy v4.4 U (http://www.xmlspy.com)-->
<SPEAR-CONFIG xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="spear.xsd">
	<MODULE>
		<NAME>Off-Prop link table populator</NAME>
		<PROCESS-ID>TEST</PROCESS-ID>
		<DESCRIPTION>For Testing</DESCRIPTION>
		<CYCLE-DEPENDENCIES>
			<ASSERTER CLASS="com.cs.sg.spear.core.cycledependency.SystemGCForcer"/>
			<ASSERTER CLASS="com.cs.sg.spear.core.cycledependency.StatsCollector"/>
		</CYCLE-DEPENDENCIES>
		<MODULE-PARAM>
		   <PARAM NAME="spear.semaphore.check" VALUE="false"/>
		   <PARAM NAME="spear.cycle.interval" VALUE="5000"/>
		   <PARAM NAME="spear.shutdown" VALUE="Wed:21:58"/>
		   <PARAM NAME="spear.cycle.count" VALUE="2"/>
		   <PARAM NAME="spear.cache.pool.size" VALUE="10"/>
    	   <PARAM NAME="spear.watcher.enable" VALUE="false"/>
   		   <PARAM NAME="spear.watcher.interval" VALUE="2000"/>	
		   <PARAM NAME="ftb.table" VALUE="tempdb..ftb_queue_04Feb09"/>	
		</MODULE-PARAM>
	</MODULE>
	<DATA-EXTRACTOR NAME="driver" TYPE="DB">
			<PARAM NAME="query"><![CDATA[
				select * from BR_INV_INVOICE where to_char(INV_INVOICE_DATE,'YYYYMM') in ('200802','200804')
				]]></PARAM>
			<PARAM NAME="resource" VALUE="INSPDEV"/>
			<PARAM NAME="fetch.size" VALUE="0"/>
			<PARAM NAME="result.wrap" VALUE="disconnected"/>			
	</DATA-EXTRACTOR>
	<DATA-TRANSFORMER NAME="trans" TYPE="script" POOL-SIZE="10" THREAD-COUNT="10">
		<PARAM NAME="rejection.report.type" VALUE="file"/>
		<PARAM NAME="rejection.report.source" VALUE="C:/app/temp/pecs/report"/>
		<PARAM NAME="script.input" VALUE="inline"/>
		<PARAM NAME="script.lang" VALUE="java"/>
		<PARAM NAME="script.value"><![CDATA[
				import com.cs.sg.spear.core.vo.DBParamHolder;
				import com.cs.sg.spear.core.dao.impl.ResultRow;
				import java.util.ArrayList;
				import java.util.List;
			
				try{
					ResultRow rr = _dataset.getDriverRow();
					//System.out.println("Driver Row:"+rr);
				}catch(Exception ex){
					throw ex;
				}
			
		]]></PARAM>
	</DATA-TRANSFORMER>
	<DATA-WRITERS ON-ERROR="failall" THREAD-COUNT="1">
		<WRITER NAME="linkTableWriter" TYPE="TEST" >
			<PARAM NAME="query"><![CDATA[insert into MIGRATIONTESTLINK1 (FOID, PRODFOINTRLID,UATFOINTRLID,STAMP_ADD_DTIME) values (MIGRATIONLINK_FOID_SEQ.NEXTVAL, ?, ?, sysdate)]]></PARAM>
			<PARAM NAME="resource" VALUE="CSARDEV"/>
			<PARAM NAME="key.name" VALUE="testLinkTable"/>
			<PARAM NAME="batch.size" VALUE="10"/>
			<PARAM NAME="batch.per.request" VALUE="true"/>
		</WRITER>
	</DATA-WRITERS>
	<RESOURCES>
		<RESOURCE NAME="INSPDEV" TYPE="DB" LOAD-PRIORITY="1" UNLOAD-PRIORITY="1">
			<PARAM NAME="driver.classname" VALUE="oracle.jdbc.OracleDriver"/>
			<PARAM NAME="connection.url" VALUE="jdbc:oracle:thin:@(description=(address_list= (address=(host=DSGINS551) (protocol=tcp)(port=15522))(address=(host=DSGINS552)(protocol=tcp) (port=15522)) (load_balance=no)(failover=yes))(connect_data=(service_name= DSGINS550.WORLD)))"/>
			<PARAM NAME="user.name" VALUE="inspire_dev"/>
			<PARAM NAME="password" VALUE="inspire_dev"/>
			<PARAM NAME="pool.size" VALUE="10"/>
			<PARAM NAME="pool.on.start" VALUE="false"/>
			<PARAM NAME="max.wait" VALUE="5000"/>
			<PARAM NAME="default.autocommit" VALUE="true"/>
		</RESOURCE>
		<RESOURCE NAME="CSARUAT" TYPE="DB" LOAD-PRIORITY="2" UNLOAD-PRIORITY="1">
			<PARAM NAME="driver.classname" VALUE="oracle.jdbc.OracleDriver"/>
			<PARAM NAME="connection.url" VALUE="jdbc:oracle:thin:@sgs75h-090d.sg.csfb.com:1521:QSGCSAR1"/>
			<PARAM NAME="user.name" VALUE="odsadm"/>
			<PARAM NAME="password" VALUE="changi2oo6"/>
			<PARAM NAME="pool.size" VALUE="10"/>
			<PARAM NAME="pool.on.start" VALUE="false"/>
			<PARAM NAME="max.wait" VALUE="5000"/>
			<PARAM NAME="default.autocommit" VALUE="true"/>
		</RESOURCE>
	</RESOURCES>
	<DATA-PROVIDERS>
		<DATA-PROVIDER NAME="checkvalue" TYPE="PROC">
			<PARAM NAME="query"><![CDATA[ 
				//System.out.println(_dataset.get("cnp_lkp$CNP_INFO")+"=="+_dataset.get("ent_lkp$ENT_INFO")+"=="+_dataset.get("ccy_lkp$CUR_INFO"));
				return RecordSet.EMPTY_RECORDSET;
			 ]]></PARAM>
		</DATA-PROVIDER>	
		<DATA-PROVIDER NAME="cnp" TYPE="DB">
			<PARAM NAME="query"><![CDATA[select * from IN_CNP_CNTR_PARTY where CNP_ID=${driver$INV_BROKER_ID}]]></PARAM>
			<PARAM NAME="resource" VALUE="INSPDEV"/>
			<PARAM NAME="fetch.size" VALUE="0"/>
			<PARAM NAME="result.wrap" VALUE="disconnected"/>
			<PARAM NAME="cache.type" VALUE="incremental"/>
		</DATA-PROVIDER>	
		<DATA-PROVIDER NAME="ent" TYPE="DB">
			<PARAM NAME="query"><![CDATA[select * from IN_ENT_ENTITY where ENT_ID=${driver$INV_ENTITY_ID}]]></PARAM>
			<PARAM NAME="resource" VALUE="INSPDEV"/>
			<PARAM NAME="fetch.size" VALUE="0"/>
			<PARAM NAME="result.wrap" VALUE="disconnected"/>
			<PARAM NAME="cache.type" VALUE="incremental"/>
		</DATA-PROVIDER>
		<DATA-PROVIDER NAME="ccy" TYPE="DB">
			<PARAM NAME="query"><![CDATA[select * from IN_CUR_CURRENCY where CUR_ID=${driver$INV_CCY_ID}]]></PARAM>
			<PARAM NAME="resource" VALUE="INSPDEV"/>
			<PARAM NAME="fetch.size" VALUE="0"/>
			<PARAM NAME="result.wrap" VALUE="disconnected"/>
			<PARAM NAME="cache.type" VALUE="incremental"/>
		</DATA-PROVIDER>
		<DATA-PROVIDER NAME="datecard" TYPE="PROC">
			<PARAM NAME="query"><![CDATA[
				import com.cs.sg.spear.core.dao.impl.ColumnHeader;
				import com.cs.sg.spear.core.dao.impl.ColumnTypes;
				import java.text.SimpleDateFormat;

				RecordSetImpl_Disconnected rd = null;
				try{
					rd = new RecordSetImpl_Disconnected();
					ColumnHeader ch = new ColumnHeader(new String[]{"SYS_DATE"},new int[]{ColumnTypes.DATE});
					rd.addRow(ch,new Object[]{new SimpleDateFormat("yyyyMMdd").parse("20080731")});
				}catch(Exception ex){
					
				}

				return rd;

			]]></PARAM>
		</DATA-PROVIDER>			
	</DATA-PROVIDERS>
	
	<DATA-LOOKUP>				
		<LOOKUP NAME="cnp_lkp" DATA-PROVIDER="cnp">
			<FILTER>CNP_ID=${driver$INV_BROKER_ID} and CNP_STATUS!='D'</FILTER>
			<COLUMNS>CONCAT(CNP_CODE,'-',CNP_NAME) as CNP_INFO</COLUMNS>
		</LOOKUP>
		<LOOKUP NAME="ent_lkp" DATA-PROVIDER="ent">
			<COLUMNS>CONCAT(ENT_CODE,'-',ENT_DESC) as ENT_INFO</COLUMNS>
		</LOOKUP>
		<LOOKUP NAME="ccy_lkp" DATA-PROVIDER="ccy">
			<COLUMNS>CONCAT(CUR_CODE,'-',CUR_DESC) as CUR_INFO</COLUMNS>
		</LOOKUP>
		<LOOKUP NAME="pc_lkp" DATA-PROVIDER="checkvalue"/>
	</DATA-LOOKUP>
	
	<EXCEPTION-HANDLER>
		<HANDLER CLASS="com.cs.sg.spear.core.exception.SpearExceptionHandler" NAME="default.exception.handler"/>
		
		<HANDLE EXCEPTION="com.cs.sg.spear.core.exception.ValidatorException" HANDLER="default.exception.handler">
			<ERROR CODE="ERROR_THRESHOLD_EXCEEDED"  VALUE="*" TYPE="fatal"/>
		</HANDLE>

		<HANDLE EXCEPTION="java.sql.SQL1Exception" HANDLER="default.exception.handler">
			<ERROR CODE="SQL_EXCEPTION"  VALUE="*" TYPE="fatal"/>
		</HANDLE>
		
		<HANDLE EXCEPTION="com.cs.sg.spear.core.exception.SpearRuntimeException" HANDLER="default.exception.handler">
			<ERROR CODE="LOOKUP_NOT_FOUND"  VALUE="*" TYPE="fatal"/>
		</HANDLE>		
	</EXCEPTION-HANDLER>
	<NOTIFIERS>
		<NOTIFIER TYPE="watcher" NAME="csarwatcher"/>
		<EVENTS>
			<EVENT TYPE="EXCEPTION" NOTIFIER="csarwatcher"/>
		</EVENTS>
	</NOTIFIERS>


</SPEAR-CONFIG>
